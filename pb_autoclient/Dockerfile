FROM ubuntu:20.04

RUN dpkg --add-architecture i386
RUN apt-get update
RUN apt-get install -y --no-install-recommends tzdata wine wine32 xvfb

ENV WINEARCH win32
ENV TZ=Europe/Kiev

ARG INSTALLER
ARG AUTOCLIENT_DIR=/autoclient
ARG AUTOCLIENT_EXE=AutoClient.exe

ENV AUTOCLIENT_DIR=$AUTOCLIENT_DIR
ENV AUTOCLIENT_EXE=$AUTOCLIENT_EXE

COPY $INSTALLER .
RUN xvfb-run wine $INSTALLER /VERYSILENT /DIR=$AUTOCLIENT_DIR
RUN rm -f $INSTALLER

WORKDIR $AUTOCLIENT_DIR
CMD wine $AUTOCLIENT_EXE
